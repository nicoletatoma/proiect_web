@{
     Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<div class="container-fluid">
     <div class="row">
          <div class="col-12">
               <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                         <h4 class="mb-0">
                              <i class="fas fa-plus-circle me-2"></i>
                              Adaugă Eveniment Nou
                         </h4>
                    </div>
                    <div class="card-body">
                         <form id="eventForm" enctype="multipart/form-data">

                              <!-- Numele Evenimentului -->
                              <div class="mb-3">
                                   <label for="eventName" class="form-label fw-bold">
                                        Numele Evenimentului <span class="text-danger">*</span>
                                   </label>
                                   <input type="text" class="form-control" id="eventName" name="eventName" required
                                          placeholder="Introduceți numele evenimentului">
                              </div>

                              <!-- Descriere -->
                              <div class="mb-3">
                                   <label for="eventDescription" class="form-label fw-bold">
                                        Descrierea Evenimentului <span class="text-danger">*</span>
                                   </label>
                                   <textarea class="form-control" id="eventDescription" name="eventDescription" rows="4" required
                                             placeholder="Descrieți evenimentul..."></textarea>
                              </div>

                              <!-- Data și Locația -->
                              <div class="row">
                                   <div class="col-md-6">
                                        <div class="mb-3">
                                             <label for="eventDate" class="form-label fw-bold">
                                                  Data Evenimentului <span class="text-danger">*</span>
                                             </label>
                                             <input type="datetime-local" class="form-control" id="eventDate" name="eventDate" required>
                                        </div>
                                   </div>
                                   <div class="col-md-6">
                                        <div class="mb-3">
                                             <label for="eventLocation" class="form-label fw-bold">
                                                  Locația <span class="text-danger">*</span>
                                             </label>
                                             <select class="form-select" id="eventLocation" name="eventLocation" required>
                                                  <option value="">Selectează locația</option>
                                                  <option value="locatie1">Locația 1</option>
                                                  <option value="locatie2">Locația 2</option>
                                                  <option value="locatie3">Locația 3</option>
                                                  <option value="locatie4">Locația 4</option>
                                                  <option value="locatie5">Locația 5</option>
                                             </select>
                                        </div>
                                   </div>
                              </div>

                              <!-- Categoria și Prețul -->
                              <div class="row">
                                   <div class="col-md-6">
                                        <div class="mb-3">
                                             <label for="eventCategory" class="form-label fw-bold">
                                                  Categoria <span class="text-danger">*</span>
                                             </label>
                                             <select class="form-select" id="eventCategory" name="eventCategory" required>
                                                  <option value="">Selectează categoria</option>
                                                  <option value="concert">Concert</option>
                                                  <option value="teatru">Teatru</option>
                                                  <option value="festival">Festival</option>
                                                  <option value="conferinta">Conferință</option>
                                                  <option value="workshop">Workshop</option>
                                                  <option value="sport">Eveniment Sportiv</option>
                                                  <option value="altele">Altele</option>
                                             </select>
                                        </div>
                                   </div>
                                   <div class="col-md-6">
                                        <div class="mb-3">
                                             <label for="eventPrice" class="form-label fw-bold">
                                                  Preț (MDL) <span class="text-danger">*</span>
                                             </label>
                                             <div class="input-group">
                                                  <input type="number" class="form-control" id="eventPrice" name="eventPrice"
                                                         required min="0" step="0.01" placeholder="0.00">
                                                  <span class="input-group-text">MDL</span>
                                             </div>
                                        </div>
                                   </div>
                              </div>

                              <!-- Imaginea Evenimentului -->
                              <div class="mb-4">
                                   <label for="eventImage" class="form-label fw-bold">
                                        Imaginea Evenimentului <span class="text-danger">*</span>
                                   </label>
                                   <input type="file" class="form-control" id="eventImage" name="eventImage"
                                          accept="image/*" required>
                                   <div class="form-text">
                                        Formateле acceptate: JPG, PNG, GIF. Mărimea maximă: 5MB.
                                   </div>

                                   <!-- Preview imagine -->
                                   <div id="imagePreview" class="mt-3 d-none">
                                        <div class="card" style="max-width: 300px;">
                                             <img id="previewImg" class="card-img-top" style="height: 200px; object-fit: cover;">
                                             <div class="card-body p-2">
                                                  <small class="text-muted">Previzualizare imagine</small>
                                             </div>
                                        </div>
                                   </div>
                              </div>

                              <!-- Alerta pentru mesaje -->
                              <div id="alertContainer"></div>

                              <!-- Butoane -->
                              <div class="d-flex justify-content-between">
                                   <button type="button" class="btn btn-secondary" onclick="resetForm()">
                                        <i class="fas fa-undo me-1"></i>
                                        Resetează
                                   </button>
                                   <div>
                                        <button type="button" class="btn btn-outline-primary me-2" onclick="saveDraft()">
                                             <i class="fas fa-save me-1"></i>
                                             Salvează Draft
                                        </button>
                                        <button type="submit" class="btn btn-primary">
                                             <i class="fas fa-check me-1"></i>
                                             Publică Evenimentul
                                        </button>
                                   </div>
                              </div>
                         </form>
                    </div>
               </div>
          </div>
     </div>
</div>

<!-- Bootstrap CSS (Include în head-ul paginii principale) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

<script>
     // Preview imagine
     document.getElementById('eventImage').addEventListener('change', function (e) {
          const file = e.target.files[0];
          const preview = document.getElementById('imagePreview');
          const previewImg = document.getElementById('previewImg');

          if (file) {
               const reader = new FileReader();
               reader.onload = function (e) {
                    previewImg.src = e.target.result;
                    preview.classList.remove('d-none');
               };
               reader.readAsDataURL(file);
          } else {
               preview.classList.add('d-none');
          }
     });

     // Setează data minimă la astăzi
     const today = new Date();
     today.setMinutes(today.getMinutes() - today.getTimezoneOffset());
     document.getElementById('eventDate').min = today.toISOString().slice(0, 16);

     // Funcție pentru afișarea alertelor
     function showAlert(type, message) {
          const alertContainer = document.getElementById('alertContainer');
          const alertHTML = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'danger' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        `;
          alertContainer.innerHTML = alertHTML;

          // Scroll la alert
          alertContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
     }

     // Resetare formular
     function resetForm() {
          if (confirm('Sigur doriți să resetați formularul? Toate datele vor fi pierdute.')) {
               document.getElementById('eventForm').reset();
               document.getElementById('imagePreview').classList.add('d-none');
               document.getElementById('alertContainer').innerHTML = '';
          }
     }

     // Salvare ca draft
     function saveDraft() {
          const formData = new FormData(document.getElementById('eventForm'));

          // Simulare salvare draft
          showAlert('info', 'Evenimentul a fost salvat ca draft.');

          // Aici vei face apelul către controller
          // fetch('/Events/SaveDraft', {
          //     method: 'POST',
          //     body: formData
          // });
     }

     // Trimiterea formularului
     document.getElementById('eventForm').addEventListener('submit', function (e) {
          e.preventDefault();

          // Validare formular
          if (!this.checkValidity()) {
               this.classList.add('was-validated');
               showAlert('danger', 'Te rugăm să completezi toate câmpurile obligatorii.');
               return;
          }

          const submitBtn = this.querySelector('button[type="submit"]');
          const originalText = submitBtn.innerHTML;

          // Schimbă textul butonului
          submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i> Se procesează...';
          submitBtn.disabled = true;

          // Simulare trimitere
          setTimeout(() => {
               showAlert('success', 'Evenimentul a fost publicat cu succes!');

               // Resetează butonul
               submitBtn.innerHTML = originalText;
               submitBtn.disabled = false;

               // Aici vei face apelul către controller
               // const formData = new FormData(this);
               // fetch('/Events/Create', {
               //     method: 'POST',
               //     body: formData
               // }).then(response => {
               //     if (response.ok) {
               //         window.location.href = '/Events';
               //     }
               // });

          }, 1500);
     });
</script>